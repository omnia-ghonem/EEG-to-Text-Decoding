{% extends "base.html" %}

{% block content %}
<section>
    <div class="login-box">
        <!-- Logo Section -->
        <div class="logo">
            <img src="static/icons/ejust_logo.png" alt="Ludiflex Logo" class="logo-img">
        </div>
        <div class="login-header">
            <header>Results</header>
        </div>

        <div class="rectangle">
            <h3>BART Prediction</h3>
            <p>{{ bart_prediction }}</p>
            {% if bart_audio_file %}


                <div class="audio-player" id="bart-audio-container">
                    <audio controls>
                        <source src="/static/{{ bart_audio_file  }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>

            {% else %}
                <!-- Button -->
                <form action="/speak" method="get">
                    <input type="hidden" name="sentence" value="{{ bart_prediction }}">
                    <button type="submit">
                        <img src="/static/icons/man_voice_icon.png" alt="Play voice" />
                    </button>
                </form>
            {% endif %}
        </div>

        <div class="rectangle">
            <h3>GPT-4 Refined</h3>
            <p>{{ gpt_refined }}</p>
            {% if gpt_audio_file %}
                <!-- Audio Player -->
                <div class="audio-container" id="gpt-audio-container">
                    <audio controls>
                        <source src="/static/{{ gpt_audio_file }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
            {% else %}
                <!-- Button -->
                <form action="/speak" method="get">
                    <input type="hidden" name="sentence" value="{{ gpt_refined }}">
                    <button type="submit">
                        <img src="/static/icons/man_voice_icon.png" alt="Play voice" />
                    </button>
                </form>
            {% endif %}
        </div>

        <a href="/index">Go back</a>
    </div>
</section>

<script>
    const urlParams = new URLSearchParams(window.location.search);

    // Handle BART Audio if available in URL
    if (urlParams.has('bart_audio')) {
        const audioFile = urlParams.get('bart_audio');
        const container = document.getElementById('bart-audio-container');
        container.innerHTML = `
            <div class="file-item">
                <p>${audioFile}</p>
                <audio controls>
                    <source src="/static/${audioFile}" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
            </div>
        `;
    }

    // Handle GPT-4 Audio if available in URL
    if (urlParams.has('gpt_audio')) {
        const audioFile = urlParams.get('gpt_audio');
        const container = document.getElementById('gpt-audio-container');
        container.innerHTML = `
            <div class="file-item">
                <p>${audioFile}</p>
                <audio controls>
                    <source src="/static/${audioFile}" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
            </div>
        `;
    }
</script>

{% endblock %}
