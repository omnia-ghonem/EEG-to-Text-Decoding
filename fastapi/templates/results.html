{% extends "base.html" %}

{% block content %}
<section>
    <div class="login-box">
    <!-- Logo Section -->
    <div class="logo">
        <img src="static/icons/ejust_logo.png" alt="Ludiflex Logo" class="logo-img">
    </div>
    <div class="login-header">
        <header>Results</header>
    </div>
    {% if audio_file %}
    <div class="audio-player">
        <h3>Audio Player:</h3>
        <audio id="invisible-audio" style="display: none;">
            <source src="{{ url_for('static', filename=audio_file) }}" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        
    </div>
    {% endif %}



    <div class="rectangle">
        <h3>BART Prediction</h3>
        <p>{{ bart_prediction }}</p>
        <form action="/speak" method="get">
            <!-- Hidden input to pass the bart_prediction -->
            <input type="hidden" name="sentence" value="{{ bart_prediction }}">
            <button type="submit">
            <img src="/static/icons/man_voice_icon.png" alt="Play voice" />
            </button>
        </form>

    </div>
    <div class="rectangle">
        <h3>GPT-4 Refined</h3>
        <p>{{ gpt_refined }}</p>
        <form action="/speak" method="get">
            <!-- Hidden input to pass the bart_prediction -->
            <input type="hidden" name="sentence" value="{{ gpt_refined }}">
            <button type="submit">
            <img src="/static/icons/man_voice_icon.png" alt="Play voice" />
            </button>
        </form>
    </div>
    <a href="/index">Go back</a>
</div>

</section>

<script>
    // Automatically play the audio if the audio query parameter is present
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('audio')) {
        const audioFile = urlParams.get('audio');
        const audioElement = document.getElementById('invisible-audio');
        
        if (audioElement) {
            const sourceElement = audioElement.querySelector('source');
            sourceElement.src = `/static/${audioFile}`;
            audioElement.load(); // Load the new audio source
            audioElement.play().catch((error) => {
                console.error("Audio autoplay failed:", error);
            });
        } else {
            console.error("Invisible audio element not found.");
        }
    }
</script>
{% endblock %}


